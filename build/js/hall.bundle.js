!function(){"use strict";const e={pageNav:document.querySelector(".page-nav"),main:document.querySelector(".main"),buyingSeanceTitle:document.querySelector(".buying__info-title"),buyingSeanceStart:document.querySelector(".buying__info-start"),buyingSeanceHall:document.querySelector(".buying__info-hall"),confStepWrapper:document.querySelector(".conf-step__wrapper"),priceStandart:document.querySelector(".price-standart"),priceVip:document.querySelector(".price-vip"),acceptinLink:document.querySelector(".acceptin-link"),acceptinButton:document.querySelector(".acceptin-button"),ticketTitle:document.querySelector(".ticket__title"),ticketChairs:document.querySelector(".ticket__chairs")};document.addEventListener("DOMContentLoaded",(()=>{localStorage.removeItem("selectChairs")}));const t=JSON.parse(localStorage.getItem("selectedMovie")),c={chairs:[],price:0};function n(){localStorage.setItem("selectChairs",JSON.stringify(c)),localStorage.setItem("selectedMovie",JSON.stringify(t))}e.buyingSeanceTitle.textContent=t.movieName,e.buyingSeanceStart.textContent=`Начало сеанса: ${t.seanceTime}`,e.buyingSeanceHall.textContent=t.hallName,e.priceStandart.textContent=t.priceStandart,e.priceVip.textContent=t.priceVip;const r=`event=get_hallConfig&timestamp=${t.seanceStart}&hallId=${t.hallId}&seanceId=${t.seanceId}`;!async function(){const a=await fetch("https://jscp-diplom.netoserver.ru/",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:r}),i=await a.json();i.result?confStepWrapper.innerHTML=i.result:e.confStepWrapper.innerHTML=t.hallConfig;const o=Array.from(document.querySelectorAll(".conf-step__chair"));Array.from(document.querySelectorAll(".conf-step__row")).forEach(((e,t)=>{e.dataset.number=t+1,Array.from(e.querySelectorAll(".conf-step__chair")).filter((e=>!e.classList.contains("conf-step__chair_disabled"))).forEach(((e,t)=>{e.dataset.number=t+1}))})),o.forEach((r=>{r.addEventListener("click",(()=>{r.classList.toggle("conf-step__chair_selected");const a=r.dataset.number,i=r.closest(".conf-step__row").dataset.number,o=r.classList.contains("conf-step__chair_standart")?Number(t.priceStandart):Number(t.priceVip);if(r.classList.contains("conf-step__chair_selected"))c.price=c.price+o,c.chairs.push(`${i}/${a}`),e.acceptinButton.disabled=!1,n();else{const t=c.chairs.indexOf(`${i}/${a}`);c.chairs.splice(t,1),c.price=c.price-o,0===c.chairs.length&&(e.acceptinButton.disabled=!0),n()}}))})),e.acceptinButton.addEventListener("click",(()=>{t.hallConfig=e.confStepWrapper.innerHTML,n()}))}()}();