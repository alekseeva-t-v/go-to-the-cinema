!function(){"use strict";const e={pageNav:document.querySelector(".page-nav"),main:document.getElementById("main"),preloader:document.querySelector(".main--skeleton"),buyingSeanceTitle:document.querySelector(".buying__info-title"),buyingSeanceStart:document.querySelector(".buying__info-start"),buyingSeanceHall:document.querySelector(".buying__info-hall"),confStep:document.querySelector(".conf-step"),confStepWrapper:document.querySelector(".conf-step__wrapper"),priceStandart:document.querySelector(".price-standart"),priceVip:document.querySelector(".price-vip"),acceptinLink:document.querySelector(".acceptin-link"),acceptinButton:document.querySelector(".acceptin-button"),ticketTitle:document.querySelector(".ticket__title"),ticketChairs:document.querySelector(".ticket__chairs"),ticketHall:document.querySelector(".ticket__hall"),ticketStart:document.querySelector(".ticket__start"),ticketCost:document.querySelector(".ticket__cost"),ticketTitle:document.querySelector(".ticket__title"),ticketChairs:document.querySelector(".ticket__chairs"),ticketHall:document.querySelector(".ticket__hall"),ticketStart:document.querySelector(".ticket__start"),ticketInfoQr:document.querySelector(".ticket__info-qr")};document.addEventListener("DOMContentLoaded",(()=>{localStorage.removeItem("selectChairs")}));const t=JSON.parse(localStorage.getItem("selectedMovie")),c={chairs:[],price:0};function r(){localStorage.setItem("selectChairs",JSON.stringify(c)),localStorage.setItem("selectedMovie",JSON.stringify(t))}e.buyingSeanceTitle.textContent=t.movieName,e.buyingSeanceStart.textContent=`Начало сеанса: ${t.seanceTime}`,e.buyingSeanceHall.textContent=t.hallName,e.priceStandart.textContent=t.priceStandart,e.priceVip.textContent=t.priceVip;const n=`event=get_hallConfig&timestamp=${t.seanceStart}&hallId=${t.hallId}&seanceId=${t.seanceId}`;!async function(){try{const o=await fetch("https://jscp-diplom.netoserver.ru/",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:n});if(!o.ok)throw new Error("Something went wrong...");const i=await o.json();i.result?e.confStepWrapper.innerHTML=i.result:e.confStepWrapper.innerHTML=t.hallConfig,e.preloader.remove(),e.confStep.style.display="block",setTimeout((()=>{e.confStep.style.opacity=1}),0);const a=Array.from(document.querySelectorAll(".conf-step__chair"));Array.from(document.querySelectorAll(".conf-step__row")).forEach(((e,t)=>{e.dataset.number=t+1,Array.from(e.querySelectorAll(".conf-step__chair")).filter((e=>!e.classList.contains("conf-step__chair_disabled"))).forEach(((e,t)=>{e.dataset.number=t+1}))})),a.forEach((n=>{n.addEventListener("click",(()=>{n.classList.toggle("conf-step__chair_selected");const o=n.dataset.number,i=n.closest(".conf-step__row").dataset.number,a=n.classList.contains("conf-step__chair_standart")?Number(t.priceStandart):Number(t.priceVip);if(n.classList.contains("conf-step__chair_selected"))c.price=c.price+a,c.chairs.push(`${i}/${o}`),e.acceptinButton.disabled=!1,r();else{const t=c.chairs.indexOf(`${i}/${o}`);c.chairs.splice(t,1),c.price=c.price-a,0===c.chairs.length&&(e.acceptinButton.disabled=!0),r()}}))})),e.acceptinButton.addEventListener("click",(()=>{t.hallConfig=e.confStepWrapper.innerHTML,r()}))}catch{console.log(error)}}()}();